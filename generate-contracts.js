const fs = require('fs');
const path = require('path');

// Contract addresses on HyperEVM Mainnet (Chain ID 999)
const MAINNET_ADDRESSES = {
  RolesAuthority: "0x86f11a6db84635f566430e7cB0224F6C4ac6a28F",
  SuperYieldVault: "0x8851862f714f2984c3E3Bcfc9Fafb57D67dB6845",
  YieldAccountant: "0xf4F3b37236Dd3e0bbcDe9EAA1C6553220A30B9aE",
  StrategyManager: "0x4E46c6826166AAD7ed6Ca0cdFCcd46818ea602aa",
  DepositTeller: "0x2f245E60EE78Acb2847D8FE1336725307C7B38Df",
};

// Read ABIs from foundry output
const contractsDir = path.join(__dirname, 'packages/foundry/out');
const outputFile = path.join(__dirname, 'packages/nextjs/contracts/deployedContracts.ts');

function readABI(contractName, fileName) {
  const abiPath = path.join(contractsDir, `${contractName}.sol`, `${fileName}.json`);
  const content = JSON.parse(fs.readFileSync(abiPath, 'utf8'));
  return content.abi;
}

// Read all ABIs
const abis = {
  RolesAuthority: readABI('RolesAuthority', 'RolesAuthority'),
  SuperYieldVault: readABI('SuperYieldVault', 'SuperYieldVault'),
  YieldAccountant: readABI('YieldAccountant', 'YieldAccountant'),
  StrategyManager: readABI('StrategyManager', 'StrategyManager'),
  DepositTeller: readABI('DepositTeller', 'DepositTeller'),
};

// Generate TypeScript file
const output = `/**
 * This file is autogenerated by Scaffold-ETH.
 * You should not edit it manually or your changes might be overwritten.
 */
import { GenericContractsDeclaration } from "~~/utils/scaffold-eth/contract";

const deployedContracts = {
  999: {
    RolesAuthority: {
      address: "${MAINNET_ADDRESSES.RolesAuthority}",
      abi: ${JSON.stringify(abis.RolesAuthority, null, 2)} as const,
    },
    SuperYieldVault: {
      address: "${MAINNET_ADDRESSES.SuperYieldVault}",
      abi: ${JSON.stringify(abis.SuperYieldVault, null, 2)} as const,
    },
    YieldAccountant: {
      address: "${MAINNET_ADDRESSES.YieldAccountant}",
      abi: ${JSON.stringify(abis.YieldAccountant, null, 2)} as const,
    },
    StrategyManager: {
      address: "${MAINNET_ADDRESSES.StrategyManager}",
      abi: ${JSON.stringify(abis.StrategyManager, null, 2)} as const,
    },
    DepositTeller: {
      address: "${MAINNET_ADDRESSES.DepositTeller}",
      abi: ${JSON.stringify(abis.DepositTeller, null, 2)} as const,
    },
  },
} as const;

export default deployedContracts satisfies GenericContractsDeclaration;
`;

fs.writeFileSync(outputFile, output);
console.log('âœ… deployedContracts.ts generated successfully!');
console.log('ðŸ“ Location:', outputFile);
console.log('ðŸ”— Chain ID: 999 (HyperEVM Mainnet)');
console.log('\nðŸ“ Contract Addresses:');
Object.entries(MAINNET_ADDRESSES).forEach(([name, address]) => {
  console.log(`   ${name}: ${address}`);
});
